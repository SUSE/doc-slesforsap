<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="sec.s4s.component">
 <title>Software Components</title>

 <para>
  As depicted in <xref linkend="fig.s4s.offering"/>,
  &sles4sap; is based on &sls; but contains several additional
  software components such as &sleha;,
  the kernel page-cache limit feature, and the installation
  workflow. These software components are briefly explained in the
  following sections.
 </para>

 <sect2 xml:id="sec.s4s.component.sles">
  <title>&sls;</title>
  <para>
   The current release is based on &sls; &productnumber;. &sls;
   is the most interoperable platform for mission-critical computing,
   both physical and virtual.
  </para>
 </sect2>

 <sect2  xml:id="sec.s4s.component.sleha">
  <title>&sleha;</title>
  <para>
   This component consists of:
  </para>
  <!-- ke 2015-05-04: https://www.suse.com/products/highavailability/features/
  -->
  <itemizedlist>
   <listitem>
    <para>
     Flexible, policy-driven clustering
    </para>
   </listitem>
   <listitem>
    <para>
     Cluster-aware file system and volume management
    </para>
   </listitem>
   <listitem>
    <para>
     Continuous data replication
    </para>
   </listitem>
   <listitem>
    <para>
     Setup and installation
    </para>
   </listitem>
   <listitem>
    <para>
     Management and administration tools
    </para>
   </listitem>
   <listitem>
    <para>
     Resource agents, also for SAP
    </para>
   </listitem>
   <listitem>
    <para>
     Virtualization-aware
    </para>
   </listitem>
  </itemizedlist>
  <para>
   &sleha; provides two resource agents specifically for working with
   SAP applications:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     <systemitem>SAPInstance</systemitem> which allows starting
     and stopping SAP instances.
    </para>
   </listitem>
   <listitem>
    <para>
     <systemitem>SAPDatabase</systemitem> which allows starting
     and stopping all databases supported by SAP applications (&hana;,
     SAP MaxDB, SAP ASE, Oracle, Sybase, IBM DB2).
    </para>
   </listitem>
  </itemizedlist>

  <para>
   For more information about &sleha;, see the &haguide; (&ha-docaddress;)
   and the White Papers and Best Practice Guides in the
   &sles4sap; Resource Library (&reslibrary;).
  </para>
 </sect2>

 <sect2 xml:id="sec.s4s.hana-replicate">
  <title>HA Resource Agents for &hana; System Replication</title>

  <para>
   &sles4sap; supports &hana; System Replication using components of &sleha;
   and two additional resource agents (RA).
  </para>

  <sect3 xml:id="sec.s4s.hana-ra">
   <title><systemitem>SAPHana</systemitem> Resource Agent</title>
   <!--
    Terms:
    + scale-up: adding more resources to an existing system
    + scale-out: adding complementary systems to your existing ones

    Replication is orthogonal to either of these: It is possible with either
    scale-up or scale-out scenarios. (It is just that SLES does not support
    scale-out at the moment.)

    Fixme/12 SP2: Are scale-out scenarios supported? FATE#318793
    - sknorr, 2016-02-04
   -->
   <!--
    Feedback from Fabian Herschel regarding the word "failover":
    "[W]e should be careful about terms like "failover" or "takeover". Because
    in the SAP HANA ecosystem, the terms are all used twice but differently
    than we do. As normally only SAP HANA users will be interested in details
    about the RAs, I suggest to follow the SAP wording to avoid confusion."
    => Use "takeover".
   -->
   <para>
    This resource agent from SUSE supports scale-up scenarios by checking the
    &hana; database instances for whether a takeover needs to happen.
    Unlike with the pure SAP solution, takeovers can be automated.
   </para>
   <para>
    It is configured as a master/slave resource: The master assumes
    responsibility for the &hana; databases running in primary mode,
    whereas the slave is responsible for instances
    that are operated in synchronous (secondary) status. In case of a takeover,
    the secondary (slave resource instance) can automatically be promoted to
    become the new primary (master resource instance).
   </para>

   <para>
    This resource agent supports system replication for the following in
    scale-up scenarios:
   </para>
   <itemizedlist>
    <listitem>
     <formalpara>
      <title>Performance-Optimized Scenario</title>
      <para>
       Two servers (A and B) in the same &sleha; cluster, one primary (A)
       and one secondary (B). The &hana; instance from the primary server (A) is
       replicated synchronously to the secondary server (B).
      </para>
     </formalpara>
    </listitem>
    <listitem>
     <formalpara>
      <title>Cost-Optimized Scenario</title>
      <para>
       The basic setup of A and B is the same as in the
       <emphasis>Performance-Optimized Scenario</emphasis>.
       However, the secondary server (B) is also used for non-productive
       purposes, such as for an additional &hana; database for development or
       QA. The production
       database is only kept on permanent memory, such as a hard disk.
       If a takeover needs to occur, the non-productive server will be stopped
       before the takeover is processed. The system resources for the
       productive database are then increased as quickly as possible via an
       SAP hook call-out script.
      </para>
     </formalpara>
    </listitem>
    <listitem>
     <formalpara>
      <title>Chain/Multi-Tier Scenario</title>
      <para>
       Three servers (A, B, and C), of which two are located in the
       same &sleha; cluster (A and B). The third server (C) is located
       externally. The &hana; system on the primary server (A) is replicated
       synchronously to the secondary server (B). The secondary server (B) is
       replicated asynchronously to the external server (C).
      </para>
     </formalpara>
     <para>
      If a takeover from A to B occurs, the connection between B and C remains
      untouched. However, B is not allowed to be the source for two servers
      (A and C), as this would be a <quote>star</quote> topology which
      is not supported with current &hana; versions (such as SPS11).
     </para>
     <para>
      Using &hana; commands, you can then manually decide what to do:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        The connection between B and C can be broken, so that B can
        connect to A.
       </para>
      </listitem>
      <listitem>
       <para>
        If replication to the external site (C) is more important than
        local system replication, the connection between B and C can be kept.
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
   </itemizedlist>
    <para>
     For all of the scenarios, &sles4sap; supports both single-tenant and
     multi-tenant &hana; databases. That is, you can use &hana; databases that
     serve multiple SAP applications.
    </para>
  </sect3>
  <sect3 xml:id="sec.s4s.topology-ra">
   <title><systemitem>SAPHanaTopology</systemitem> Resource Agent</title>
   <para>
    To make configuring the cluster as simple as possible, SUSE has
    developed the <systemitem>SAPHanaTopology</systemitem> resource agent.
    This agent runs on all
    nodes of a &sleha; cluster and gathers information about the status and
    configurations of &hana; system replications. It is designed as a
    normal (stateless) clone.
   </para>
  </sect3>
  <sect3 xml:id="sec.s4s.hana-replicate.more">
   <title>For More Information</title>
   <para>
    For more information, see:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      The &haguide; at &docaddress;.
     </para>
    </listitem>
    <listitem>
     <para>
      The <emphasis>White Papers</emphasis> and <emphasis>Best Practice
      Guides</emphasis> in the Resource Library at &reslibrary;.
      In particular, see
      <citetitle>Automate your SAP HANA System Replication Failover</citetitle>.
     </para>
    </listitem>
   </itemizedlist>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.s4s.component.install">
 <title>Installation Workflow</title>
  <para>
   The installation workflow offers a guided installation path for both the
   &sls; operating system and the SAP application.
   <!-- ke: jweber does not want plural ("applications") here.-->
   For more information, see <xref linkend="sec.s4s.workflow-overview"/>.
  </para>
  <para>
   Additionally, the installation workflow can be extended by
   third-party vendors or customers using &supmedia;. For more information about
   creating &supmedia;, see <xref linkend="app.s4s.component.supplement"/>.
  </para>
 </sect2>

 <sect2 xml:id="sec.s4s.component.page-cache">
  <title>Page-Cache Limit</title>
  <para>
   You can limit the kernel file system cache size to influence swapping
   behavior. With this feature, you can often gain better performance by
   allocating memory to an application. For more information, see
   <xref linkend="sec.s4s.configure.page-cache"/>.
  </para>
 </sect2>

 <sect2 xml:id="sec.s4s.component.clamsap">
  <title>Antivirus Protection with ClamSAP</title>
  <para>
   ClamSAP integrates the ClamAV antivirus toolkit into &netweaver; and
   SAP Mobile Platform applications to enable
   cross-platform threat detection.
   For example, you can use ClamSAP to allow an SAP application to scan for
   malicious uploads in HTTP uploads.
   ClamSAP can be installed from the package <systemitem>clamsap</systemitem>.
   To use virus scanning within &netweaver;, you need to enable it there
   (<menuchoice><guimenu>Transaction</guimenu>
   <guimenu>VSCAN</guimenu></menuchoice>).
  </para>
  <para>
   ClamSAP is a shared library that links between ClamAV and the
   &netweaver; Virus Scan Interface (NW-VSI) by SAP. The version of ClamSAP
   shipped with &productname; &productnumber; supports NW-VSI version 2.0.
  </para>
 </sect2>

 <sect2 xml:id="sec.s4s.component.hana-secure">
  <title>SAP HANA Security</title>
  <para>
   &sles4sap; contains additional features to help set up well-secured &hana;
   installations.
  </para>

  <sect3 xml:id="sec.s4s.component.firewall-hana">
   <title>Firewall for &hana;</title>
   <para>
    &hana; often requires more firewall zones than the standard installation of
    &susefirewall; provides. For this reason, &sles4sap; additionally
    provides the package <systemitem>HANA-Firewall</systemitem> which
    integrates with &susefirewall;. It contains preconfigured zone setups and
    rules to make securing &hana; as simple as possible.
   </para>
   <para>
    For more information, see <xref linkend="sec.s4s.configure.firewall-hana"/>.
   </para>
  </sect3>

  <sect3 xml:id="sec.s4s.component.harden">
   <title>Hardening Guide for &hana;</title>
   <para>
    For information on hardening the underlying operating system, see the
    &sles4sap; resource library: &reslibrary;. There, find the document
    <citetitle>OS Security Hardening for &hana;</citetitle>.
   </para>
   <remark>
    Calling a Guide "software" is a bit of a stretch... But it is not really a
    service either, unfortunately. If those are the only two categories we can
    work with... - sknorr, 2016-02-11
   </remark>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.s4s.component.manage-operation">
  <title>Simplified Operations Management</title>
  <para>
    &sles4sap; combines several features that enable simplified operations
    management.
  </para>

  <sect3 xml:id="sec.s4s.component.sapconf">
   <title>System Tuning with <command>saptune</command></title>
   <para>
    The system tuning application <command>saptune</command> allows you to
    automatically and comprehensively tune your system as recommended by
    &sap; for use with &s4h;, &netweaver;, or &hana;/&b1;. To do this,
    <command>saptune</command> activates
    <systemitem class="daemon">tuned</systemitem> profiles. These allow
    tuning several kernel parameters, depending on the hardware components
    you are using, such as the amount of available RAM.
   </para>
   <para>
    For more information, see <xref linkend="sec.s4s.configure.sapconf"/>.
   </para>
  </sect3>

  <sect3 xml:id="sec.s4s.component.cryptctl">
   <title>Encryption for Hosted Volumes with <command>cryptctl</command></title>
   <para>
    Today, databases and similar applications are often hosted on external
    servers that are serviced by third-party staff. Certain data center
    maintenance tasks require third-party staff to directly access affected
    systems. In such cases, privacy requirements necessitate disk encryption.
   </para>
   <para>
    <command>cryptctl</command> allows encrypting entire volumes using LUKS
    and offers the following additional features:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Encryption keys are located on a central server which can be located
      customer premises.
     </para>
    </listitem>
    <listitem>
     <para>
      Encrypted volumes are remounted after an unplanned reboot.
     </para>
    </listitem>
   </itemizedlist>
   <!--<para>
    For more information, see <xref linkend="sec.s4s.configure.cryptctl"/>.
   </para>-->
  </sect3>

  <!-- Apparently unsupported in 12 SP1, so commenting. - sknorr, 2016-02-11 -->
  <!-- <sect3 xml:id="sec.s4s.component.clusterconnector">
   <title><systemitem>suse_sap_cluster_connector</systemitem></title>
   <para>
    <systemitem>suse_sap_cluster_connector</systemitem> allows making all
    products based on <systemitem>sapstartstopsrv</systemitem> aware of
    high-availability clusters created with &sles4sap;.
   </para>
   <para>
    This allows you use tools such as the Microsoft&thrdmrk; Management Console
    or <systemitem>sapcontrol</systemitem> to manage &sles4sap; clusters.
   </para>
  </sect3> -->

  <sect3 xml:id="sec.s4s.component.pattern">
   <title>Patterns Providing Dependencies of Various SAP Applications</title>
   <para>
    To simplify working with software dependencies of SAP applications, &suse;
    has created patterns that combine relevant dependency RPM packages for
    specific applications:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <guimenu>SAP BusinessOne Server Base</guimenu>
     </para>
    </listitem>
    <listitem>
     <para>
      <guimenu>SAP HANA Server Base</guimenu>
     </para>
    </listitem>
    <listitem>
     <para>
      <guimenu>SAP NetWeaver Server Base</guimenu>
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>
     Packages May Be Missing from Patterns
    </title>
    <para>
     The selection of packages of the software patterns are defined while a
     specific release (Service Pack or major version) of &sles4sap; is
     developed. This package selection is stable over the lifetime of this
     particular release. When working with SAP applications that have been
     released more recently than your &sles4sap; version,
     dependencies can be missing from the patterns.
    </para>
    <para>
     For definitive information about the dependencies of your SAP application,
     consult the documentation provided to you by SAP.
    </para>
   </important>
  </sect3>

  <sect3 xml:id="sec.s4s.component.clustertool">
   <title><systemitem>ClusterTools2</systemitem></title>
   <para>
    <systemitem>ClusterTools2</systemitem> provides tools that help set up
    and manage a Corosync/<systemitem>pacemaker</systemitem> cluster. Among
    them are <systemitem>wow</systemitem> which helps create
    highly available system resources, and
    <systemitem>ClusterService</systemitem> which allows managing a cluster.
   </para>
   <para>
    Additionally, <systemitem>ClusterTools2</systemitem> provides scripts that
    automate common cluster tasks:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Scripts that perform checks. For example, to find out whether a system is
      set up correctly for creating a <systemitem>pacemaker</systemitem>
      cluster.
     </para>
    </listitem>
    <listitem>
     <para>
      Scripts that simplify configuration. For example, to create a Corosync
      configuration.
     </para>
    </listitem>
    <listitem>
     <para>
      Scripts that monitor the system and scripts that show or collect
      system information. For example, to find known error patterns in
      log files.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    For more information, see the man page of the respective tool which are
    included with the package <package>ClusterTools2</package>.
   </para>
  </sect3>
 </sect2>

</sect1>
