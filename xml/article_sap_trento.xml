<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="file:/usr/share/xml/geekodoc/rng/geekodoc5-flat.rnc"
   type="application/relax-ng-compact-syntax"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;

  <!-- Trento specific entities -->
  <!ENTITY trentoadmin          "trentoadmin">
  <!ENTITY trentoserverip       "192.168.1.2">
  <!ENTITY trentoservername     "<replaceable
    xmlns='http://docbook.org/ns/docbook'>TRENTO_SERVER_HOSTNAME</replaceable>">
  <!ENTITY trentoagentname      "<replaceable xmlns='http://docbook.org/ns/docbook'>TRENTO_AGENT</replaceable>">
  <!ENTITY trentoprompt         "&trentoadmin;@&trentoservername;:~>">
  <!ENTITY trentoagentprompt    "&trentoadmin;@&trentoagentname;:~>">
  <!ENTITY trentoserver.prompt  "<prompt xmlns='http://docbook.org/ns/docbook'>&trentoprompt; </prompt>">
  <!ENTITY trentoagent.prompt   "<prompt xmlns='http://docbook.org/ns/docbook'>&trentoagentprompt; </prompt>">
  <!ENTITY t.server             "Trento Server">
  <!ENTITY t.agent              "Trento Agent">
  <!ENTITY t.web                "Trento web console">
  <!ENTITY k8s                  "Kubernetes">
  <!ENTITY rancher.k8s.engine   "Rancher &k8s; Engine">
]>

<!--

2021-11-18
As agreed on https://confluence.suse.com/x/DAEcN on our Trento doc kick off

-->

<article xml:lang="en" xml:id="article-sap-trento" version="5.1" status="draft"
    xmlns="http://docbook.org/ns/docbook"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Getting started with Trento</title>
  <subtitle>&sles4sapreg;</subtitle>
  <info>
    <abstract>
      <para> Trento is a an open cloud-native web console that aims to
                help &sap; administrators to improve monitoring and checking of
                &sap; Applications. </para>
    </abstract>
    <xi:include href="common_copyright_gfdl.xml" />
    </info>

  <important>
    <title>Trento is an evolving product</title>
    <para> The product is under active development, and it currently
      supports only selected customers with the purpose of collecting
            their feedback. If you'd like to join the program, contact us at
                <email>project-trento@suse.com</email>. </para>
  </important>

  <section xml:id="sec-trento-what">
    <title>What is Trento?</title>
    <!--<para>
      Trento is a an open cloud-native web console aimed to help administrators to improve
            monitoring and checking of &sap; Applications.
        </para>-->
    <para> Trento is a comprehensive monitoring solution consisting of two
      main components, the &t.server; and the &t.agent;. Trento provides
            the following features: </para>
    <!--
      from https://confluence.suse.com/x/uoOyN
        * A simple agent which can run on SLES4SAP hosts which are used to operate SAP S/4HANA
        * Proactive checks to ensure correct settings of SUSE solutions (e.g. SUSE HA solutions) for running SAP.
        * Capabilities to discover and monitor the state of the hosts running SAP including all
          information in the context of SAP systems and landscapes.
    -->
    <itemizedlist>
      <listitem>
        <para>A simplified web UI targeting &sap; admins. </para>
      </listitem>
      <listitem>
        <para>Automated discovery of &sap; Systems, &sap; Instances, and
          &hana; clusters.</para>
      </listitem>
      <listitem>
        <para>Configuration validation for &hana; Scale-Up
          Performance-Optimized scenarios deployed on MS Azure
          cloud.</para>
      </listitem>
    </itemizedlist>

    <para> The <emphasis role="strong">&t.server;</emphasis> is an
      independent, cloud-native, distributed system and designed to run on
            dedicated infrastructure resources. It provides a web front end. </para>
    <para> The <emphasis role="strong">&t.agent;</emphasis> is a single
      background process (<systemitem>trento agent</systemitem>) running
            on each host of the target infrastructure monitored by the user.
            Except for third-party modules<!-- like Consul and ARA-->, all the
            components are included in a single Trento binary. </para>
    <para> For Trento, &suse; collects telemetry data relevant for further
      product development. </para>
    <para> See <xref linkend="fig-trento-architecture" /> for additional
      details. </para>
    <!-- toms 2021-11-26: Do we have a vector graphic for this?
      https://github.com/trento-project/trento/blob/main/docs/trento-architecture.svg.
    -->
    <figure xml:id="fig-trento-architecture">
      <title>Architectural overview</title>
      <!--
        replace SAP Application Platform Cluster with
        SAP NetWeaver Cluster
      -->
      <mediaobject>
        <imageobject>
          <imagedata width="80%"
            fileref="trento-architecture-outline.png" />
          <!-- Source: https://confluence.suse.com/display/SAP/Architecture -->
        </imageobject>
      </mediaobject>
    </figure>
  </section>

  <section xml:id="sec-trento-product-lifecycle-update-strategy">
    <title>Product lifecycle and update strategy</title>
    <!--
      Most ist taken from https://confluence.suse.com/x/uoOyN
    -->
    <para>The main components have different product lifecycles:</para>

    <variablelist>
      <varlistentry>
        <term>&t.agent;</term>
        <listitem>
          <formalpara>
            <title>Delivery mechanism:</title>
            <para>RPM package for &productname; 15&nbsp;SP1 and
              newer.</para>
          </formalpara>
          <formalpara>
            <title>Supported runtime:</title>
            <para> Supports &productname; 15&nbsp;SP1 and newer.
            </para>
          </formalpara>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>&t.server;</term>
        <listitem>
          <formalpara>
            <title>Delivery mechanism:</title>
            <para> A set of container images from the &suse;
              registry together with a Helm chart for easy
              installation. </para>
          </formalpara>
          <formalpara>
            <title>&k8s;:</title>
            <para> The &t.server; runs on any current Cloud Native
              Computing Foundation (CNCF) certified &k8s;
              distributions. Depending on your background and
              needs, &suse; support several usage scenarios:
            </para>
          </formalpara>
          <itemizedlist>
            <listitem>
              <para> If you already use a CNCF certified &k8s;,
                you can run the &t.server; in it. </para>
            </listitem>
            <listitem>
              <para> If you have no &k8s; and want enterprise
                support, &suse; recommends &suse; Rancher with
                &rancher.k8s.engine; (RKE) either version 1 or
                2. </para>
            </listitem>
            <listitem>
              <para> If you do not have &k8s; and you do not need
                professional support, &suse; recommends using
                K3s which can be installed on a single host.
              </para>
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
    </variablelist>

    <remark>toms 2021-12-09: what about the update strategy? aj: something
      for next year. :) </remark>
  </section>

<!--
 toms 2021-11-19:
 Do we have specific terms which needs to be explained in a terminology section?
-->

  <section xml:id="sec-trento-requirements">
    <title>Requirements</title>
    <para> This section describes requirements for the &t.server; and its
      &t.agent;s. </para>
    <section xml:id="sec-trento-server-requirements">
      <title>&t.server; requirements</title>
      <para> Running all the &t.server; components requires 2GB of RAM and
        two CPU cores. </para>
      <para> While the &t.server; supports various usage scenarios,
        depending on the existing infrastructure, it's designed to be
        cloud-native and OS agnostic. As such, the default installation
        method provisions a minimal, single node, K3S &k8s; cluster for
        running its components in Linux containers. The &t.server; can
        be installed on the following services: </para>
      <!--
        toms 2021-12-06: taken from "Draft - Various Tidbits regarding Productization"
        (https://confluence.suse.com/x/tgCnMg)
      -->
      <itemizedlist>
        <listitem>
          <para>RKE1 (&rancher.k8s.engine; version 1)</para>
        </listitem>
        <listitem>
          <para>RKE2</para>
        </listitem>
        <listitem>
          <para>any other CNCF certified &k8s;</para>
        </listitem>
      </itemizedlist>
    </section>
    <section xml:id="sec-trento-agent-requirements">
      <title>&t.agent; requirements</title>
      <para> The resource footprint of the &t.agent; is designed to not
        impact the performance of the host it runs on. </para>
      <para> The &t.agent; component needs to interact with several
        low-level system components that are part of the &productname;
        distribution. </para>
    </section>
    <section xml:id="sec-trento-network-requirements">
      <title>Network requirements</title>
      <para />
      <remark>toms 2021-12-02: which ports do we need?</remark>
      <itemizedlist>
        <listitem>
          <para> Ensure that the Trento component running &k8s; has a
            network access to the &sap; landscape. </para>
        </listitem>
        <listitem>
          <para>
            <remark>toms 2021-12-06: do we have UDP here
              too?</remark> The &t.server; needs to reach its
            &t.agent;s hosts via SSH (port TCP/22). </para>
        </listitem>
        <listitem>
          <para> The &t.server; must be reachable from the &sap;
            admin's LAN via HTTP (port TCP/80). </para>
        </listitem>
      </itemizedlist>
    </section>

    <section xml:id="sec-trento-installation-prerequisites">
      <title>Installation pre-requisites</title>
      <itemizedlist>
        <listitem>
          <formalpara>
            <title>&t.server;</title>
            <para>Access to GitHub for the installation
              script.</para>
          </formalpara>
        </listitem>
        <listitem>
          <formalpara>
            <title>&t.agent;s</title>
            <para>A registered &productname; distribution.</para>
          </formalpara>
        </listitem>
        <listitem>
          <formalpara>
            <title>A Trento admin user</title>
            <para> With administration privileges in the &t.server;
              host and the &t.agent; hosts. In this example, we
              will refer to it as <systemitem class="username"
                >&trentoadmin;</systemitem>. You can use any
              desired user name, but make sure you use it
              consistently accross the landscape. </para>
          </formalpara>
        </listitem>
      </itemizedlist>
    </section>
  </section>

  <section xml:id="sec-trento-installing-trentoserver">
    <title>Installing &t.server;</title>
    <important>
      <title>Expect changes in the installation procedure</title>
      <para>
        The product is under active development. Expect changes in the described
        installation procedure. RPM packages for Trento are in the works.
      </para>
    </important>

    <para> The procedure uses the following placeholders: </para>
    <itemizedlist>
      <listitem>
        <para><replaceable>TRENTO_SERVER_HOSTNAME</replaceable>: the
          host name of the &t.server; host.</para>
      </listitem>
      <!--<listitem>
        <para>
        <systemitem class="username">&trentoadmin;</systemitem>: the user name of the Trento
        administrator. In our example, it is <systemitem class="username"
        >&trentoadmin;</systemitem>. You can use any desired user name, but make sure you use it consistently.
        </para>
        </listitem>-->
      <!--<listitem>
        <para><replaceable>TRENTO_AGENT_IP</replaceable>: local IP address of the &t.agent; host.</para>
        </listitem>-->
    </itemizedlist>
    <para> To install &t.server; on your &t.server; host proceed as follows: </para>
    <procedure>
      <step>
        <para> Log on the &t.server; host as user <systemitem
          class="username">&trentoadmin;</systemitem>. </para>
      </step>
      <step xml:id="st-trento-server-ssh">
        <para> On the &t.server; host, create an SSH key for user
          <systemitem class="username">&trentoadmin;</systemitem>
          with no passphrase: </para>
        <screen>&trentoserver.prompt;ssh-keygen -f ~/.ssh/id_rsa -t rsa -b 4096 -N ''</screen>
      </step>
      <step>
        <para> Launch the installer script: </para>
        <screen>&trentoserver.prompt;curl -sfL https://raw.githubusercontent.com/trento-project/trento/main/install-server.sh | bash</screen>
      </step>
      <step>
        <para> Enter the absolute path to the private SSH key from <xref
          linkend="st-trento-server-ssh" /> (normally
          <filename>/home/&trentoadmin;/.ssh/id_rsa</filename>): </para>
        <screen>Please provide the path of the runner private key: /home/&trentoadmin;/.ssh/id_rsa</screen>
        <para> The runner service uses the private key to perform checks
          in the agent hosts via SSH. The script installs the required
          components. If the installation has been completed
          correctly, the script displays the following message: </para>
        <screen>&t.server; installed!</screen>
      </step>
      <step>
        <para> Check whether the &t.server; is up and running: </para>
        <screen>&trentoserver.prompt;sudo /usr/local/bin/kubectl get pods
NAME                                      READY   STATUS    RESTARTS   AGE
svclb-trento-server-web-collector-x2hmd   1/1     Running   0          42m
trento-server-consul-server-0             1/1     Running   0          42m
trento-server-consul-qv65d                1/1     Running   0          42m
trento-server-postgresql-0                1/1     Running   0          42m
trento-server-ara-77fb85b46d-mb756        1/1     Running   0          42m
trento-server-web-df665479-rlghw          1/1     Running   2          42m
trento-server-runner-5cdc4995b6-f96vb     1/1     Running   1          42m</screen>
      </step>
      <!-- alberto: hide for the time being until we figure out what the role of these ports really is.
        <step>
        <para>
        To ensure your &t.agent;s are able to connect to the &t.server;,
        check the network ports:
        </para>
        <screen>&trentoserver.prompt;sudo /usr/local/bin/kubectl describe pod trento-server-web-df665479-rlghw | grep -i port    Ports:         8080/TCP, 8081/TCP
        Host Ports:    0/TCP, 0/TCP
        -\-db-port
        -\-port
        -\-collector-port</screen>
        </step>
      -->
      <step>
        <para> Log out the &t.server; host. </para>
      </step>
      <step>
        <para> To verify that the &t.server; installation was
          successful, open the URL of the &t.web;
          (<uri>http://<replaceable>TRENTO_SERVER_HOSTNAME</replaceable></uri>)
          from a workstation located in the &sap; admin's LAN. </para>
      </step>
    </procedure>
  </section>

  <section xml:id="sec-trento-installing-trentoagent">
    <title>Installing &t.agent;s</title>
    <important>
      <title>Expect changes in the installation procedure</title>
      <para>
        The product is under active development. Expect changes in the described
        installation procedure. RPM packages for Trento are in the works.
      </para>
    </important>

    <para> Repeat the following steps on each host to be monitored in your
      &sap; Environment. </para>
    <para> The procedure uses the following placeholders: </para>
    <itemizedlist>
      <listitem>
        <para><replaceable>TRENTO_SERVER_IP</replaceable>: local IP
          address of the &t.server; host.</para>
      </listitem>
      <listitem>
        <para><replaceable>TRENTO_AGENT_IP</replaceable>: local IP
          address of the &t.agent; host.</para>
      </listitem>
      <listitem>
        <para><replaceable>TRENTO_AGENT</replaceable>: host name of the
          &t.agent; host.</para>
      </listitem>
    </itemizedlist>
    <para> To install the &t.agent; software on the host and register it
      with the &t.server;, proceed as follows: </para>
    <procedure>
      <step>
        <para> Add the public SSH key of the user <systemitem
          class="username">&trentoadmin;</systemitem> generated on
          the &t.server; host to the file
          <filename>~/.ssh/authorized_keys</filename> of user
          &trentoadmin; on the &t.agent; host. This step is necessary
          to enable the runner checks in the &t.agent; host via SSH.
        </para>
      </step>
      <step>
        <para> Add the &t.agent; host to the list of known hosts on your
          &t.server; by logging in once via SSH as <systemitem
            class="username">&trentoadmin;</systemitem>: </para>
        <substeps>
          <step>
            <para> Log in on the &t.server; host as <systemitem
              class="username">&trentoadmin;</systemitem>.
            </para>
          </step>
          <step>
            <para> Connect to the &t.agent; host using SSH and
              answer <literal>yes</literal> when asked whether to
              continue or not with the connection process: </para>
            <screen>&trentoserver.prompt;ssh <replaceable>TRENTO_AGENT_IP</replaceable>
[...]
Are you sure you want to continue connecting (yes/no/[fingerprint])? <emphasis role="strong">yes</emphasis>
Warning: Permanently added '<replaceable>TRENTO_AGENT_IP</replaceable>' (ECDSA) to the list of known hosts.</screen>
          </step>
        </substeps>
      </step>
      <step>
        <para> Install the &t.agent; software in the &t.agent; host and
          register the agent with the &t.server;: </para>
        <screen>&trentoagent.prompt;curl -sfL https://raw.githubusercontent.com/trento-project/trento/main/install-agent.sh | sudo bash -s - --agent-bind-ip=<replaceable>TRENTO_AGENT_IP</replaceable> --server-ip=<replaceable>TRENTO_SERVER_IP</replaceable></screen>
        <!--
          Installing trento-agent...
          warning: Rebuilding outdated index databases
          warning: Generating 18 missing index(es), please wait...
          * Adding Trento repository: https://download.opensuse.org/repositories/devel:/sap:/trento/15.3/.
          * Installing trento
          * Generating trento-agent config...
          Done.
          Now you can start trento-agent with: systemctl start trento-agent
          Please make sure the server is running before starting the agent.
        -->
      </step>
      <!-- alberto: I don't think this is really necessary. Question for the dev team.
        <step>
        <para>On the current VM &trentoagentname;, add and refresh the OBS repository:</para>
        <screen>&trentoagent.prompt;sudo zypper ar https://download.opensuse.org/repositories/devel:/sap:/trento:/factory/15.3/ trento_OBS
        sudo zypper ref</screen>
        </step>
      -->
      <step>
        <para>The installation script does not start the agent
          automatically. Enable automatic start on boot with the
          command <command>systemctl</command>:</para>
        <screen>&trentoagent.prompt;sudo systemctl enable --now trento-agent</screen>
      </step>
      <step>
        <para>Check the status of the &t.agent;:</para>
        <screen>&trentoagent.prompt;sudo systemctl status trento-agent
● trento-agent.service - &t.agent; service
     Loaded: loaded (/usr/lib/systemd/system/trento-agent.service; disabled; vendor preset: disabled)
     Active: active (running) since Wed 2021-11-24 17:37:46 UTC; 4s ago
   Main PID: 22055 (trento)
      Tasks: 10
     CGroup: /system.slice/trento-agent.service
             ├─22055 /usr/bin/trento agent start --consul-config-dir=/srv/consul/consul.d
             └─22220 /usr/bin/ruby.ruby2.5 /usr/sbin/SUSEConnect -s

[...]</screen>
        <remark>toms 2021-11-25: do we need to "enable the auto-update
          feature of the extension agent and restarting the service"?
          The login message teills us to execute as root: sed -i
          s/AutoUpdate.Enabled=n/AutoUpdate.Enabled=y/
          /etc/waagent.conf ; rcwaagent restart </remark>
        <remark>toms 2021-11-25: </remark>
      </step>
      <step>
        <para> Repeat this procedure in all &t.agent; hosts. </para>
      </step>
    </procedure>
  </section>

  <section xml:id="sec-trento-webconsole">
    <title>Using &t.web;</title>
    <remark>toms 2021-12-13: this section is a bit too referential and needs
      more focus on the user. As discussed with Alberto, we keep it for
      the time being and change it after the release. </remark>
    <para> The left sidebar in the &t.web; contains the following entries: </para>
    <itemizedlist>
      <listitem>
        <formalpara>
          <title><guimenu>Home</guimenu></title>
          <para> It gives an overview of the Trento project. </para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><guimenu>Hosts</guimenu></title>
          <para>Lists all registered hosts running the
            &t.agent;.</para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><guimenu>&pace; Clusters</guimenu></title>
          <para>Lists all discovered &pace; clusters.</para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><guimenu>&sap; Systems</guimenu></title>
          <para>Lists all discovered &sap; Systems; identified by the
            corresponding system IDs. </para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><guimenu>HANA Database</guimenu></title>
          <para> Lists all discovered &hana; databases identified by
            the corresponding system IDs. </para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><menuchoice>
            <guimenu>Settings</guimenu>
            <guimenu>Checks catalog</guimenu>
          </menuchoice></title>
          <para>Shows the catalog of configuration checks that Trento
            may carry out for different cluster components (&pace;,
            &corosync; SBD, etc.).</para>
        </formalpara>
      </listitem>
      <listitem>
        <formalpara>
          <title><guimenu>About</guimenu></title>
          <para>Shows the current Trento version, the link to the
            GitHub repository of Trento, the type of subscription
            and the number of registered &productname; hosts
            .</para>
        </formalpara>
      </listitem>
    </itemizedlist>
    <para> The following subsections provides an overview of Trento's
      functionality. </para>

    <section xml:id="sec-trento-web-hosts">
      <title>Hosts view</title>
      <para> To display the lists of registered hosts, click the
        <guimenu>Hosts</guimenu> entry in the left sidebar. </para>
      <figure>
        <title>Hosts entry</title>
        <mediaobject>
          <imageobject>
            <imagedata width="80%" fileref="trento-web-hosts.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para> This view provides the following information: </para>
      <itemizedlist>
        <listitem>
          <para> A <guimenu>Health</guimenu> section on top with a
            summary of the health status of the registered hosts.
          </para>
        </listitem>
        <listitem>
          <para> A list of registered hosts with the following info
            for each one of them: Healh Status (Passing, Warning or
            Critical), hostname, local IP address, cloud provider
            (when applicable), cluster name (when application),
            system ID (when applicable), the &t.agent;'s version and
            custom tags that you can add and remove manually.
          </para>
        </listitem>
        <listitem>
          <para> Ability to filter the list by health status, &sap;
            System ID, or custom tags. </para>
        </listitem>
      </itemizedlist>

      <para> Clicking on a host name opens the corresponding <guimenu>Host
        details</guimenu> view, where you can see the following: </para>
      <itemizedlist xml:id="lst-trento-web-hosts-details">
        <title>Host details view</title>
        <listitem>
          <para><guimenu>Hosts details</guimenu> section: it provides
            the hostname, the &sap; System ID (when applicable); the
            cluster name (when applicable) and the &t.agent;
            version.</para>
        </listitem>
        <listitem>
          <para><guimenu>Cloud details</guimenu> section: when
            applicable, it provides the name of the virtual machine,
            the name of the resource group it belongs to, the
            location, the size of the virtual machine, and other
            information. </para>
        </listitem>
        <listitem>
          <para><guimenu>&suse; subscription details</guimenu>
            section: it lists the different components or modules
            that are part of the subscription and for each one of
            them it provides the architecture, the version and type,
            the registration and subscription status as well as the
            start and end dates of the subscription. </para>
        </listitem>
        <listitem>
          <para><guimenu>Trento Agent status</guimenu> section: it
            shows the status and output of the corresponding
            &t.agent;. </para>
        </listitem>
        <listitem>
          <para><guimenu>&sap; instances</guimenu> section: when a
            &sap; instance runs on the hosts, it lists its different
            processes providing for each one of them the following
            information: process name, description, start time,
            elapsed time (since start up), Pid and Status. </para>
        </listitem>
      </itemizedlist>
    </section>

    <section xml:id="sec-trento-show-pacemaker-clusters">
      <title>Showing &pace; clusters</title>
      <para> To display a list of the discovered &pace; clusters, click
        the <guimenu>&pace; Clusters</guimenu> entry on the left
        sidebar. </para>
      <important>
        <para> Keep in mind that during introductory phase only &hana;
          scale-up clusters are currently under consideration. </para>
      </important>
      <figure>
        <title>&pace; clusters</title>
        <mediaobject>
          <imageobject>
            <imagedata width="80%"
              fileref="trento-web-pacemaker.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para> This view provides the following: </para>
      <itemizedlist>
        <listitem>
          <para> A <guimenu>Health</guimenu> section on top providing
            a summary of the &pace; clusters status based on the
            selected configuration checks for each one of them. See
            <xref linkend="lst-trento-web-cluster-details" />
            for more information. </para>
        </listitem>
        <listitem>
          <para> A list of registered clusters with the following
            information for each one of them: status (based on
            configuration checks), cluster name, cluster ID, cluster
            type, SID (when applicable), number of hosts, number of
            resources, and custom tags that can added/removed
            manually. </para>
        </listitem>
        <listitem>
          <para> The ability to filter clusters by health status,
            name, SID, type, or tags. </para>
        </listitem>
      </itemizedlist>
      <para> Clicking on the name or ID of one of the clusters, opens the
        <guimenu>&pace; Cluster details</guimenu> view in which we
        can find the following: </para>
      <itemizedlist xml:id="lst-trento-web-cluster-details">
        <title><guimenu>&pace; Cluster details</guimenu> view</title>
        <listitem>
          <para> A <guimenu>Settings</guimenu> button next to the
            <guimenu>&pace; Cluster details</guimenu> page
            header which will open the Cluster settings window:
            <xref
              linkend="fig-trento-web-pagemaker-cluster-settings"
            />. </para>
          <figure xml:id="fig-trento-web-pagemaker-cluster-settings">
            <title>&pace; <guimenu>Cluster
              settings</guimenu></title>
            <mediaobject>
              <imageobject>
                <imagedata width="50%"
                  fileref="trento-web-pacemaker-cluster-settings.png"
                />
              </imageobject>
            </mediaobject>
          </figure>
          <para> In this window you can change the following settings: </para>
          <itemizedlist xml:id="lst-trento-web-pace-cluster-settings">
            <title><guimenu>Cluster settings</guimenu></title>
            <listitem>
              <para><guimenu>Connection settings</guimenu>: set
                the Trento administrator that is used to connect
                to your hosts. In this article, it is
                <systemitem class="username"
                  >&trentoadmin;</systemitem>. </para>
            </listitem>
            <listitem>
              <para>
                <guimenu>Checks selection</guimenu>:
                select/deselect a complete category of a test
                (such as &corosync;, &pace; etc.) or individual
                tests. </para>
            </listitem>
          </itemizedlist>
          <para> Do not forget to save your changes before closing the
            window. </para>
        </listitem>
        <listitem>
          <para>On the top left, a section with the most relevant
            cluster attributes including &hana; system replication
            mode, &hana; system replication operation mode,
            SAPHanaSR health state and &hana; secondary sync state. </para>
          <informalfigure>
            <mediaobject>
              <imageobject>
                <imagedata width="60%"
                  fileref="trento-web-pagemaker-cluster-details-header.png"
                />
              </imageobject>
            </mediaobject>
          </informalfigure>
        </listitem>
        <listitem>
          <para>On the top right side, a <guimenu>Health</guimenu>
            section with number of configuration checks in Passing,
            Warning or Critical status. For detail information on
            the different configuration checks, click on
            <guimenu>Show check results</guimenu> button. This
            view gives you a brief overview of passed and failed
            checks. The <guimenu>Health Details</guimenu> view can
            be shortened by <xref
              linkend="lst-trento-web-pace-cluster-settings" />.
            There, you can select the tests to include in the view. </para>
          <informalfigure>
            <mediaobject>
              <imageobject>
                <imagedata width="20%"
                  fileref="trento-web-pagemaker-cluster-details-health.png"
                />
              </imageobject>
            </mediaobject>
          </informalfigure>
        </listitem>
        <listitem>
          <para> A <guimenu>Stopped resources</guimenu> section
            listing all stopped resources in the current &pace;
            cluster. </para>
        </listitem>
        <listitem>
          <para>A <guimenu>&pace; Site details</guimenu> section
            showing the different sites that are configured for this
            cluster. For each site, its name is displayed along with
            the hostname, the local IP, the virtual IP and the role
            of the corresponding node. Clicking on the hostname
            takes you to the corresponding <xref
              linkend="lst-trento-web-hosts-details" />. Clicking
            on the <guimenu>Details</guimenu> button to the right
            opens a window with two tabs: in one tab you can see the
            main attributes of the node, in the other one you can
            see the list of resources running on it. </para>
          <informalfigure>
            <mediaobject>
              <imageobject>
                <imagedata width="60%"
                  fileref="trento-web-pacemaker-cluster-site.png"
                />
              </imageobject>
            </mediaobject>
          </informalfigure>
        </listitem>
        <listitem>
          <para>A <guimenu>SBD/Fencing</guimenu> section listing the
            configured SBD devices and their location. </para>
        </listitem>
      </itemizedlist>
      <!--<para>
        Clicking <guimenu>Settings</guimenu> button on the <guimenu>&pace; Cluster details</guimenu> page shows
        <xref linkend="fig-trento-web-pagemaker-cluster-settings"/>.
        </para>
        <figure xml:id="fig-trento-web-pagemaker-cluster-settings">
        <title>&pace; <guimenu>Cluster settings</guimenu></title>
        <mediaobject>
        <imageobject>
        <imagedata width="50%" fileref="trento-web-pacemaker-cluster-settings.png"/>
        </imageobject>
        </mediaobject>
        </figure>-->
    </section>

    <section xml:id="sec-trento-sap-systems-view">
      <title>&sap; Systems view</title>
      <para> Click the <guimenu>&sap; Systems</guimenu> entry in the left
        sidebar to get an overview of the registered &sap; Systems: </para>
      <figure>
        <title>&pace; clusters</title>
        <mediaobject>
          <imageobject>
            <imagedata width="80%"
              fileref="trento-web-sapsystems.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para> This view provides the following: </para>
      <itemizedlist>
        <listitem>
          <para> A list of registered &sap; Systems with the following
            information for each one of them: system ID (SID),
            description, ID of the corresponding database,
            corresponding tenant name, DB IP address, and custom
            tags that you can manually set/remove. By clicking on
            the down arrow icon left to the SID, a list with all the
            instances that part of this &sap; System, including
            database instances, is displayed and for each one of
            them you can see the corresponding SID, the features
            (processes) it provides, the instance number, the
            cluster name (when applicable) and the host where it is
            running. </para>
        </listitem>
        <listitem>
          <para> Ability to filters &sap; Systems by SID and tags.
          </para>
        </listitem>
      </itemizedlist>

      <para> Clicking on a <guimenu>SID</guimenu> entry, opens up the
        <guimenu>SAP Systems</guimenu> details view which displays
        the following: </para>
      <itemizedlist>
        <title>&sap; System details</title>
        <listitem>
          <para>the <guimenu>Name</guimenu> and
            <guimenu>Type</guimenu> of this &sap; System.</para>
        </listitem>
        <listitem>
          <para>
            <guimenu>The NetWeaver; instances layout</guimenu>: for
            each instance, virtual hostname, instance number,
            features (processes), HTTP and HTTPs ports, start
            priority, and SAPControl status. </para>
        </listitem>
        <listitem>
          <para>
            <guimenu>The list of hosts where the different NetWeaver
              instances are running</guimenu>, with the hostname,
            the IP address, the cloud provider (when applicable),
            the cluster name (when applicable), the &sap; System ID,
            and the &t.agent; version for each listed host. When you
            click the hostname, it shows you the details described
            in <xref linkend="lst-trento-web-hosts-details" />.
          </para>
        </listitem>
      </itemizedlist>
    </section>

    <section xml:id="sec-trento-hana-db-view">
      <title>&hana; databases view</title>
      <para> To get an overview of registered &hana; databases, click the
        <guimenu>HANA databases</guimenu> entry in the left sidebar. </para>
      <figure>
        <title>HANA databases</title>
        <mediaobject>
          <imageobject>
            <imagedata width="80%" fileref="trento-web-hanadb.png"
            />
          </imageobject>
        </mediaobject>
      </figure>
      <para>This view provides the following:</para>
      <itemizedlist>
        <listitem>
          <para> A list of registered &hana; databases with the
            following information for each one of them: system ID
            (SID), description, and custom tags that you can
            manually set/remove. By clicking on the down arrow icon
            left to the SID, a list of all related instances is
            displayed and for each one of them you can see the
            corresponding SID, the features (processes) it provides,
            the instance number, the system replication role, the
            cluster name (when applicable) and the host where it is
            running. </para>
        </listitem>
        <listitem>
          <para> Ability to filters &hana; databases by SID and tags.
          </para>
        </listitem>
      </itemizedlist>
      <para> Clicking on one of the <guimenu>SID</guimenu>s opens the
        <guimenu>HANA Databases</guimenu> detail view which shows
        the following: </para>
      <itemizedlist>
        <title><guimenu>HANA Database</guimenu> details view</title>
        <listitem>
          <para>
            <guimenu>Layout</guimenu> section: lists all related
            &hana; instances with their corresposding hostname,
            instance number, features (processes), HTTP/HTTPS ports,
            start priorities, and SAPControl status. </para>
        </listitem>
        <listitem>
          <para>
            <guimenu>Hosts</guimenu> section: lists the hosts where
            all the related instances are running and for each host
            it provides the hostname, the local IP address, the
            cloud provider (when applicable), the cluster name (when
            applicable), the system ID, and the &t.agent; version. </para>
          <para> Clicking on a host name takes you to the
            corresponding <xref
              linkend="lst-trento-web-hosts-details" />. </para>
        </listitem>
      </itemizedlist>
    </section>

    <section xml:id="sec-trento-configuration-checks">
      <title>Configuration checks</title>
      <para> To get an overview of the configuration checks that Trento
        can manage click the <menuchoice>
          <guimenu>Settings</guimenu>
          <guimenu>Checks catalog</guimenu>
        </menuchoice> entry in the left sidebar. </para>
      <figure>
        <title><menuchoice>
          <guimenu>Settings</guimenu>
          <guimenu>Checks catalog</guimenu>
        </menuchoice></title>
        <mediaobject>
          <imageobject>
            <imagedata width="80%"
              fileref="trento-web-settings-catalogs.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para> The view shows the configuration checks that Trento can
        perform for the different cluster components: &corosync;,
        &pace;, SBD, Azure Fence Agent, &hana; System Replication
        Resource Agent, OS and package version, and miscellaneous. </para>
      <para> Checks are grouped by components. Each test is identified by
        a test ID, next to which we can see the check description and an
        info icon. By clicking on the info icon we get detail
        information about the corresponding check: abstract, remediation
        actions (what to do when the check is negative) and related
        references. </para>
      <para> What checks are carried out for each particular cluster is
        determined using the <guimenu>Settings</guimenu> button in the
        corresponding cluster detail view. See <xref
          linkend="lst-trento-web-pace-cluster-settings" /> for
        details. </para>
    </section>
  </section>

  <section xml:id="sec-trento-updating-trentoserver">
    <title>Updating &t.server;</title>
    <para> To update the &t.server;, do the following: </para>
    <procedure>
      <step>
        <para> Ensure the &t.server; is running. </para>
      </step>
      <step>
        <para> On the &t.server; host start the update: </para>
        <screen>&trentoagentprompt;sudo curl -sfL https://raw.githubusercontent.com/trento-project/trento/main/install-server.sh | bash
        </screen>
      </step>
      <step>
        <para>Check the &t.server; processes:</para>
        <screen>&trentoagentprompt;sudo kubectl get pod</screen>
      </step>
      <step>
        <para> Open the &t.web; URL
          <uri>http://<replaceable>TRENTO_SERVER_HOSTNAME</replaceable></uri>.
        </para>
      </step>
      <step>
        <para> To check the new version, hover the mouse pointer over
          the info button in the lower-left corner. </para>
      </step>
    </procedure>
  </section>

  <section xml:id="sec-trento-updating-trentoagent">
    <title>Updating a &t.agent;</title>
    <para> To update the &t.agent;, do the following: </para>
    <procedure>
      <step>
        <para>Log in the &t.agent; host as the Trento admin user
          <systemitem class="username"
            >&trentoadmin;</systemitem>.</para>
      </step>
      <step>
        <para>Stop the &t.agent;:</para>
        <screen>&trentoagent.prompt;sudo systemctl stop trento-agent</screen>
      </step>
      <step>
        <para>Confirm the &t.agent; is down:</para>
        <screen>&trentoagent.prompt;sudo systemctl status trento-agent</screen>
      </step>
      <step>
        <para>Update &t.agent;, using the &t.agent; host local IP and
          the &t.server; host local IP:</para>
        <screen>&trentoagent.prompt;curl -sfL https://raw.githubusercontent.com/trento-project/trento/main/install-agent.sh | sudo bash -s - --agent-bind-ip=<replaceable>TRENTO_AGENT_IP</replaceable> --server-ip=<replaceable>TRENTO_SERVER_IP</replaceable></screen>
      </step>
      <step>
        <para>Start the &t.agent;:</para>
        <screen>&trentoagent.prompt;sudo systemctl enable --now trento-agent</screen>
      </step>
      <step>
        <para>Check the version on the &t.web;.</para>
        <substeps>
          <step>
            <para>Open the &t.web; URL
              <uri>http://<replaceable>TRENTO_SERVER_HOSTNAME</replaceable></uri>.</para>
          </step>
          <step>
            <para> In the menu section, click the
              <guimenu>Hosts</guimenu> entry. Use tags to
              filter the list, if necessary. </para>
          </step>
          <step>
            <para> Find the corresponding &t.agent; host name in the
              list. </para>
          </step>
          <step>
            <para> Check the version of the agent running in the
              <guimenu>Agent version</guimenu> column. </para>
          </step>
          <step>
            <para>Optionally, click the &t.agent; hostname and
              review the host status details.</para>
          </step>
        </substeps>
      </step>
    </procedure>
  </section>

  <!--<xi:include href="common_legal.xml"/>-->
</article>
