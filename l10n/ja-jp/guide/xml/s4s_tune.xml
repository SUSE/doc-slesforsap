<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="s4s_tune.xml" version="5.0" xml:id="cha-tune">
 <title>チューニング</title>
 
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 
 <para>
  この章では、SUSE Linux Enterprise Server for SAP ApplicationsがSAPアプリケーションと最適に連携できるようにチューニングする方法について説明します。
 </para>
 <sect1 xml:id="sec-saptune">
  <title><command>saptune</command>を使用したシステムのチューニング</title>

  <para>
   <command>saptune</command>を使用すると、SAP NetWeaver、SAP HANA/SAP BusinessObjects、およびSAP S/4HANAアプリケーション用にシステムをチューニングできます。この方法は、システムチューニングサービス<systemitem class="daemon">tuned</systemitem>に依存します。
  </para>

  <para>
   <command>saptune</command>を使用するには、パッケージ<package>tuned</package>と<package>saptune</package>がシステムにインストールされていることを確認してください。
  </para>



  <sect2 xml:id="sec-saptune-enable">
   <title>SAPアプリケーションのチューニングのための<command>saptune</command>の有効化</title>
   <procedure xml:id="pro-tune">
    <step>
     <para>
      システムをチューニングするには、まず、チューニングソリューションを見つけます。適切なソリューションを見つけるには、次のコマンドを使用します。
     </para>
<screen><prompt>tux &gt; </prompt><command>saptune solution list</command></screen>
     <para>
      <command>saptune</command>では、次のチューニングソリューション(SAP Notesのグループ)を認識します。
     </para>
     <itemizedlist>
      <listitem>
       <formalpara>
        <title><literal>BOBJ</literal></title>
        <para>
         SAP BusinessObjectsを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>HANA</literal></title>
        <para>
         SAP HANAデータベースを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>MAXDB</literal></title>
        <para>
         SAP MaxDBデータベースを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>NETWEAVER</literal></title>
        <para>
         SAP NetWeaverアプリケーションサーバを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>S4HANA-APPSERVER</literal></title>
        <para>
         SAP S/4HANAアプリケーションサーバを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>S4HANA-APP+DB</literal></title>
        <para>
         SAP S/4HANAアプリケーションサーバとSAP HANAの両方を同じホスト上で実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>S4HANA-DBSERVER</literal></title>
        <para>
         SAP S/4HANAインストールのSAP HANAデータベースを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>SAP-ASE</literal></title>
        <para>
         SAP Adaptive Server Enterpriseデータベースを実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara>
        <title><literal>NETWEAVER+HANA</literal></title>
        <para>
         SAPアプリケーションサーバとSAP HANAの両方を同じホスト上で実行するためのソリューション。
        </para>
       </formalpara>
      </listitem>
     </itemizedlist>
     <para>
      または、特定のSAP Notesからの推奨事項に従って、コンピュータをチューニングできます。チューニングできるNotesのリストは次のコマンドを介して入手できます。。
     </para>
<screen><prompt role="root">root # </prompt><command>saptune note list</command></screen>
    </step>
    <step>
     <itemizedlist>
      <listitem>
       <para>
        事前設定されたソリューションを使用して<command>saptune</command>を設定するには、次のコマンドを使用します。
       </para>
<screen><prompt role="root">root # </prompt><command>saptune solution apply <replaceable>SOLUTION</replaceable></command></screen>
      </listitem>
      <listitem>
       <para>
        特定のSAPノートの推奨事項に合わせて<command>saptune</command>を設定するには、次のコマンドを使用します。
       </para>
<screen><prompt role="root">root # </prompt><command>saptune note apply <replaceable>NOTE</replaceable></command></screen>
      </listitem>
     </itemizedlist>
     <note>
      <title>最適化の組み合わせ</title>
      <para>
       ソリューションとノートを組み合わせることができます。ただし、一度にアクティブにできるのは1つのソリューションのみです。まれに、ノートでオプションまたはパラメータの競合が発生する可能性があります。競合を避けるには、最後のノートが常に以前のノートの競合するオプションまたはパラメータを上書きすることに注意してください。
      </para>
     </note>
    </step>
    <step>
     <para>
      <command>saptune</command>を開始し、ブート時に有効にするには、次のコマンドを実行してください。
     </para>
<screen><prompt role="root">root # </prompt><command>saptune daemon start</command></screen>
    </step>
   </procedure>
   <para>
    バックグラウンドで、<command>saptune</command>は、選択した<quote>ソリューション</quote>および<quote>ノート</quote>に従って動的にカスタマイズされる<command>saptune</command>とも呼ばれる<systemitem class="daemon">tuned</systemitem>プロファイルを適用します。<command>tuned-adm list</command>を使用して、このプロファイルを表示することもできます。
   </para>
  </sect2>

  <sect2 xml:id="sec-saptune-customize">
   <title>SAPノートのカスタマイズ</title>
   <para>
    すべてのSAPノートは次のコマンドを使用して自由に設定できます。<remark>"customise" is (sadly) correct. - sknorr, 2019-07-19</remark>
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note customise</command></screen>
   <para>
    このコマンドには、値の変更やパラメータの無効化が含まれています。
   </para>
  </sect2>

  <sect2 xml:id="sec-saptune-create">
   <title>新しいSAPノートの作成</title>
   <para>
    新しいSAPノートを次のコマンドを使用して作成できます。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note create</command></screen>
   <para>
    <command>saptune</command>のすべての機能が利用できます。
   </para>
  </sect2>

  <sect2 xml:id="sec-saptune-delete">
   <title>SAPノートの削除</title>
   <para>
    このコマンドを使用すると、作成されたノートを削除できます。対応する上書きファイルが利用可能な場合は、それも削除されます。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note delete test</command>
Note to delete is a customer/vendor specific Note.
Do you really want to delete this Note (test2)? [y/n]: y</screen>
   <para>
    ノートはその時点では適用されない場合があります。次の点に注意してください。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      アクションを完了するには確認が必要です。
     </para>
    </listitem>
    <listitem>
     <para>
      <command>saptune</command>で提供された内部SAPノートは削除できません。代わりに、利用可能な場合は、上書きファイルが削除されます。
     </para>
    </listitem>
    <listitem>
     <para>
      ノートがすでに適用されている場合、コマンドは、ノートを削除する前に元に戻す必要があるという情報で終了します。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec-saptune-rename">
   <title>SAPノートの名前の変更</title>
   <para>
    このコマンドを使用すると、作成されたノートを新しい名前に変更することができます。対応する上書きファイルが利用可能な場合は、このファイルの名前も変更されます。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note rename test test2</command>
Note to rename is a customer/vendor specific Note.
Do you really want to rename this Note (test) to the new name 'test2'? [y/n]: y</screen>
   <para>
    ノートはその時点では適用されない場合があります。次の点に注意してください。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      アクションを完了するには確認が必要です。
     </para>
    </listitem>
    <listitem>
     <para>
      <command>saptune</command>で提供された内部SAPノートの名前は変更できません。
     </para>
    </listitem>
    <listitem>
     <para>
      ノートがすでに適用されている場合、コマンドは、ノートを削除する前に元に戻す必要があるという情報で終了します。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec-saptune-show">
   <title>SAPノートの設定の表示</title>
   <para>
    ノート提供時の設定は、次のコマンドで一覧表示できます。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note show</command></screen>
  </sect2>

  <sect2 xml:id="sec-saptune-verify">
   <title>SAPノートまたはSAPソリューションの確認</title>
   <para>
    コマンド<command>saptune note verify <replaceable>NOTE</replaceable></command>および<command>saptune solution verify <replaceable>SOLUTION</replaceable></command>は、アクティブまたは要求されたノートごとに次のデータを一覧表示します。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      パラメータ名
     </para>
    </listitem>
    <listitem>
     <para>
      予想される値(デフォルト)
     </para>
    </listitem>
    <listitem>
     <para>
      設定された上書き(<command>saptune customise</command>を使用して作成)
     </para>
    </listitem>
    <listitem>
     <para>
      現在のシステム値
     </para>
    </listitem>
    <listitem>
     <para>
      現在の状態がSAP推奨事項に従っているかどうか
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec-saptune-simulate">
   <title>SAPノートまたはSAPソリューションのアプリケーションのシミュレート</title>
   <para>
    <literal>note</literal>の各パラメータを表示するには、次のコマンドを使用します。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune note simulate</command></screen>
   <para>
    <literal>solution</literal>の各パラメータを表示するには、次のコマンドを使用します。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune solution simulate</command></screen>
   <para>
    現在のシステム値と予想される値(デフォルトおよび上書き)を一覧表示します。
   </para>
  </sect2>

  <sect2 xml:id="sec-saptune-disable">
   <title><command>saptune</command>の無効化</title>
   <para>
    <command>saptune</command>を無効にして、<systemitem class="daemon">tuned</systemitem>を停止および無効にするには、次のコマンドを実行します。
   </para>
<screen><prompt role="root">root # </prompt><command>saptune daemon stop</command></screen>
  </sect2>

  <sect2 xml:id="sec-saptune-more">
   <title>詳細の参照先</title>
   <para>
    次のマニュアルページを参照してください。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <command>man 8 saptune</command>
     </para>
    </listitem>
    <listitem>
     <para>
      <command>man 8 saptune_v1</command>
     </para>
    </listitem>
    <listitem>
     <para>
      <command>man 8 saptune_v2</command>
     </para>
    </listitem>
    <listitem>
     <para>
      <command>man 8 saptune-migrate</command>
     </para>
    </listitem>
    <listitem>
     <para>
      <command>man 8 saptune-note</command>
     </para>
    </listitem>
   </itemizedlist>
   <para>
    プロジェクトホームページ(<link xlink:href="https://github.com/SUSE/saptune/"/>)も参照してください。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-sysctl">
  <title><command>sysctl</command>を使用したカーネルパラメータの手動チューニング</title>

  <para>
   <command>saptune</command>を使用してカーネルパラメータをチューニングする際は、<command>sysctl</command>を使用して、カーネルパラメータを手動調整することもできます。また、saptuneを使用したカーネルパラメータのチューニングの代わりに、sysctlを使用して、カーネルパラメータを手動調整することもできます。ただし、<command>sysctl</command>を使用したこのような変更は、デフォルトでは再起動後も持続しません。再起動後も持続するようにするには、<command>sysctl</command>によって読み込まれた設定ファイルのいずれかにそれらを追加します。
  </para>

  <tip>
   <title><command>sysctl</command>と<command>saptune</command></title>
   <para>
    SAPシステムに<command>sysctl</command>パラメータを設定する場合は、このような設定を管理する中心的なツールとして<command>saptune</command>を使用することを検討してください。
   </para>
  </tip>

  <para>

   <command>sysctl</command>に関する詳細については、マニュアルページの<literal>sysctl(8)</literal>、<literal>sysctl.conf(5)</literal>、および<literal>sysctl.d(5)</literal>を参照してください。
  </para>
 </sect1>
 <xi:include href="s4s_tune_wmp.xml"/>
</chapter>
