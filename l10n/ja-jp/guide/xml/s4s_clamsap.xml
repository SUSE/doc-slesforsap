<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
   type="text/xml"
   title="Profiling step"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="s4s_clamsap.xml" version="5.0" xml:lang="ja" xml:id="cha-clamsap">
 <title>ClamSAPを使用したマルウェアに対する保護</title>
 
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 
  <para>
   ClamSAPは、ClamAVマルウェア対策ツールキットをSAP NetWeaverおよびSAP Mobile Platformアプリケーションに統合します。ClamSAPは、ClamAVとSAP NetWeaver Virus Scan Interface (NW-VSI)の間をリンクする共有ライブラリです。SUSE Linux Enterprise Server for SAP Applications 15 SP3に付属しているClamSAPのバージョンは、NW-VSIバージョン2.0をサポートしています。
  </para>
 <sect1 xml:id="sec-clamsap-install">
  <title>ClamSAPのインストール</title>
  <procedure>
   <step>
    <para>
     アプリケーションホストに、ClamAVとClamSAPのパッケージをインストールします。そのためには、次のコマンドを使用してください。
    </para>
    <screen><prompt>tux &gt; </prompt><command>sudo zypper install clamav clamsap</command></screen>
   </step>
   <step>
    <para>
     デーモン<systemitem class="daemon">clamd</systemitem>を有効にする前に、マルウェアデータベースを初期化します。
    </para>
    <screen><prompt>tux &gt; </prompt><command>sudo freshclam</command></screen>
   </step>
   <step>
    <para>
     サービス<systemitem class="daemon">clamd</systemitem>を開始します。
    </para>
    <screen><prompt>tux &gt; </prompt><command>sudo systemctl start clamd</command></screen>
   </step>
   <step>
    <para>
     次のコマンドを使用してサービス<systemitem class="daemon">clamd</systemitem>のステータスを確認します。
    </para>
    <screen>
<prompt>tux &gt; </prompt><command>systemctl status clamd</command>
● clamd.service - ClamAV Antivirus Daemon
Loaded: loaded (/usr/lib/systemd/system/clamd.service; enabled; vendor preset: disabled)
Active: active (running) since Tue 2017-04-11 10:33:03 UTC; 24h ago
[...]
    </screen>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-clamsap-scannergroup">
  <title>SAP NetWeaverでのウィルススキャナグループの作成</title>
  <procedure>
   <step>
    <para>
     GUIを使用してSAP NetWeaverインストールにログインします。<systemitem class="username">DDIC</systemitem>または<systemitem class="username">SAP*</systemitem>ユーザとしてログインしないでください。ウィルススキャナをcross-clientに設定する必要があるためです。
    </para>
   </step>
   <step>
    <para>
     トランザクション<guimenu>VSCANGROUP</guimenu>を使用してウィルススキャナグループを作成します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-scanner-group-display.jpg" format="JPG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-scanner-group-display.jpg" width="85%" format="JPG"/>
      </imageobject>
      <textobject role="description">
       <phrase>編集可能なテーブルを使用してビュー「スキャナグループ」を編集する</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     ビューモードから変更モードに切り替えるには、<guimenu>Change View (ビューの変更) (</guimenu><inlinemediaobject>
      <textobject role="description">
       <phrase>ビューの変更</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>)ボタンをクリックします。
    </para>
    <para>
      チェックマークをクリックして、<guimenu>This table is cross-client (このテーブルはクロスクライアントです)</guimenu>というメッセージを確認します。テーブルが編集可能になりました。
    </para>
   </step>
   <step>
    <para>
     最初の空の行を選択します。<guimenu>Scanner Group (スキャナグループ)</guimenu>テキストボックスで、<literal>CLAMSAPVSI</literal>を指定します。<guimenu>Group Text (グループテキスト)</guimenu>で、<literal>CLAMSAP</literal>を指定します。
    </para>
    <para>
     <guimenu>Business Add-in (ビジネスアドイン)</guimenu>がオフになっていることを確認します。
    </para>
    <informalfigure>
     <mediaobject>
      <textobject role="description">
       <phrase>編集可能なテーブルを使用してビュー「スキャナグループ」を編集する</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-scanner-group-change.jpg" format="JPG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-scanner-group-change.jpg" width="85%" format="JPG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     フォームを保存するには、<guimenu>保存</guimenu>(<inlinemediaobject>
      <textobject role="description">
       <phrase>保存</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-save-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-save-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>)ボタンをクリックします。
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-clamsap-library">
  <title>SAP NetWeaverでのClamSAPライブラリの設定</title>
  <procedure>
   <step>
    <para>
     SAP NetWeaver GUIで、トランザクション<guimenu>VSCAN</guimenu>をコールします。
     
    </para>
   </step>
   <step>
    <para>
     ビューモードから変更モードに切り替えるには、<guimenu>Change View (ビューの変更) (</guimenu><inlinemediaobject>
      <textobject role="description">
       <phrase>ビューの変更</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>)ボタンをクリックします。
    </para>
    <para>
      チェックマークをクリックして、<guimenu>This table is cross-client (このテーブルはクロスクライアントです)</guimenu>というメッセージを確認します。テーブルが編集可能になりました。
    </para>
   </step>
   <step>
    <para>
     <guimenu>New entries (新しいエントリ)</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     必要に応じて、次のフォームに入力します。
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <guimenu>Provider Type (プロバイダタイプ)</guimenu>: <literal>Adapter (Virus Scan Adapter)</literal>
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>プロバイダ名</guimenu>: <literal>VSA_<replaceable>HOSTNAME</replaceable></literal> (例: <literal>VSA_SAPSERVER</literal>)
      </para>
     </listitem>
     <listitem>
      <para>
       <literal>Scanner Group (スキャナグループ)</literal>: <xref linkend="sec-clamsap-scannergroup"/>で設定したスキャナグループの名前(例: <literal>CLAMSAPVSI</literal>)
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>サーバ</guimenu>: <literal><replaceable>HOSTNAME</replaceable>_<replaceable>SID</replaceable>_<replaceable>INSTANCE_NUMBER</replaceable></literal> (例: <literal>SAPSERVER_P04_00</literal>)
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>Adapter Path (アダプタパス)</guimenu>: <filename>libclamdsap.so</filename>
      </para>
     </listitem>
    </itemizedlist>
    <informalfigure>
     <mediaobject>
      <textobject role="description">
       <phrase>新しいエントリ: 追加されたエントリの詳細フォーム</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-scanner-definition-add.jpg" format="JPG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-scanner-definition-add.jpg" width="85%" format="JPG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     フォームを保存するには、<inlinemediaobject>
      <textobject role="description">
       <phrase>保存</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-save-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-save-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>ボタンをクリックします。
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-clamsap-changedir">
  <title>ウィルス定義のデフォルトの場所の設定</title>
  <para>
   デフォルトで、ClamAVはウィルス定義が<filename class="directory">/var/lib/clamsap</filename>にあることを想定しています。このデフォルトの場所を変更するには、次の手順に従います。
  </para>
  <procedure>
   <step>
    <para>
     GUIを使用してSAP NetWeaverインストールにログインします。<systemitem class="username">DDIC</systemitem>または<systemitem class="username">SAP*</systemitem>ユーザとしてログインしないでください。ウィルススキャナをcross-clientに設定する必要があるためです。
    </para>
   </step>
   <step>
    <para>
     <literal>CLAMSAPVSI</literal>グループを選択します。
    </para>
   </step>
   <step>
    <para>
     左のナビゲーションペインで、<guimenu>Configuration Parameters (設定パラメータ)</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     ビューモードから変更モードに切り替えるには、<guimenu>Change View (ビューの変更) (</guimenu><inlinemediaobject>
      <textobject role="description">
       <phrase>ビューの変更</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-viewmode-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>)ボタンをクリックします。
    </para>
    <para>
      チェックマークをクリックして、<guimenu>This table is cross-client (このテーブルはクロスクライアントです)</guimenu>というメッセージを確認します。テーブルが編集可能になりました。
    </para>
    <figure xml:id="fig-clamsap-add-entry">
     <title/>
     <mediaobject>
      <imageobject role="html">
       <imagedata fileref="sap-new-scanner-clamsap-add-entries.jpg" width="95%"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-new-scanner-clamsap-add-entries.jpg" width="85%"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para>
     <guimenu>New Entries (新しいエントリ)</guimenu>をクリックし、<parameter>INITDRIVERDIRECTORY</parameter>を選択します。
    </para>
    <figure xml:id="fig-clamsap-add-value">
     <title/>
     <mediaobject>
      <imageobject role="html">
       <imagedata fileref="sap-new-scanner-clamsap-add-value.jpg" width="95%"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-new-scanner-clamsap-add-value.jpg" width="85%"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step>
    <para>
     別のウィルススキャナの場所へのパスを入力します。
    </para>
   </step>
   <step>
    <para>
     フォームを保存するには、<guimenu>保存</guimenu>(<inlinemediaobject>
      <textobject role="description">
       <phrase>保存</phrase>
      </textobject>
      <imageobject role="html">
       <imagedata fileref="sap-nw-save-icon.png" width="1em" format="PNG"/>
      </imageobject>
      <imageobject role="fo">
       <imagedata fileref="sap-nw-save-icon.png" width="0.8em" format="PNG"/>
      </imageobject>
     </inlinemediaobject>)ボタンをクリックします。
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-clamsap-engage">
  <title>ClamSAPの実行</title>
  <para>
   ClamSAPを実行するには、トランザクション<guimenu>VSCAN</guimenu>に移動します。続いて［<emphasis>開始</emphasis>］をクリックします。
  </para>
  <figure xml:id="fig-clamsap-scanner-change">
   <title>ビュー<quote>ウィルススキャンプロバイダ定義</quote>を変更する</title>
   <mediaobject>
    <imageobject role="html">
     <imagedata fileref="sap-nw-scanner-definition-change.jpg" format="JPG"/>
    </imageobject>
    <imageobject role="fo">
     <imagedata fileref="sap-nw-scanner-definition-change.jpg" width="85%" format="JPG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   その後、ClamSAPとClamAVの詳細を含む概要が表示されます(<xref linkend="fig-clamsap-summary"/>を参照)。
  </para>
  <figure xml:id="fig-clamsap-summary">
   <title>ClamSAPデータの概要</title>
   <mediaobject>
    <imageobject role="html">
     <imagedata fileref="sap-nw-scanner-summary.jpg" format="JPG"/>
    </imageobject>
    <imageobject role="fo">
     <imagedata fileref="sap-nw-scanner-summary.jpg" width="85%" format="JPG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="sec-clamsap-more">
  <title>詳細の参照先</title>
  <para>
   詳細については、プロジェクトホームページ<link xlink:href="https://sourceforge.net/projects/clamsap/"/>も参照してください。
  </para>
 </sect1>
</chapter>
